package ru.innopolis.spring.gpa;

/**
 * Created by olymp on 01.12.2016.
 */


@Entity
public class Human {
    @id
    private long id;
    @OneToMany
    private List<Car> cars;
    @JoinColumn
}
Можно использовать только list, map, set.
Все заполненные объекты вместе с ключами хранятся в persistance контексте.
EntytyManager - позволяет управлять ..., создается сам, EmtityManagerFactory
передаем id ...
Жизненный цикл: 4 ступени
1. Новый - entity создан, нет идентификатора, не управляется persistence persist()
2. Управляемый - внутри контекста
3. Detached - не рассматривается как часть persistence контекста
4. Удаленный - +id,... Удаляется после коммита транзакции
new ->persist()->managed->persist()->
                        <-
removed->persist()->^
detach()->detached->persist()->exception
merge, flush
session пользоваться нежелательно, сложнее перейти
____________________________________________________________
    Query api.
Нативные sql запросы.
    Критерий  api.
Получаем строго типизированный асписок: List<Cars>
_____________________________________________________________
Кэшинг. 2 уровня. 1 уровень:Второй такой же запрос не будет строиться - в одной сесии
2 можно подключить - между транзакциями - можно указать какие объ кэшировать
3 уровень - кэш запроса
1запрос
1а запрос у кэша
2обращение к бд
2б положить в кэш
3отправка ответа
______________________________________________________________
Оптимистическач блокировка
есть поле версии
    @Version
    private long version
    Есть проверка структур таблиц и pojo
Можно наследовать id, version:
3 варианта
от одного ентити
от класса не яваляется ентити: @MappedSuperClass
использовать ...
persistance.xml
логин пароль транзакции наименование персистанс ...
список классов где найти,

    Fetch type
у не персистент - manytomany можно указать тип инициализации
String name;
Типы подтягивания
FetchType.LAZY - only getCars() - makes query - на прокси основано типа,
на самом деле на наследовании, хорошо, пока на одной машине. Нужен слой ДАО.
ДАО+Сервис на одной машине=HumanDTO  - а на самом деле модель, HumanModel
FetchType.EAGER - all bears, default
controller->service(business-logic, работает с логической моделью)
BPA - автоматизация бизнес процессов
Orica -
Пагинация - что если 1е6 студентов, выводит пачками, те автоскроллиг или 123...last
ModelDrivenDevelopment - есть сущьности, entity генерятся автоматом
View генерятся автоматом
____________________________________________________________
привести в порядок структуры
entity manager